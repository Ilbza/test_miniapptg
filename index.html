<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Запись на вводное занятие</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding:20px; background:#f3e8ff; }
    button { padding: 10px; margin:10px 0; cursor:pointer; }
    input { padding: 8px; margin: 5px 0; width: 90%; }
    .logo { width: 100px; margin-bottom: 10px; }
  </style>
</head>
<body>

<div id="form">
  <img src="logo.png" alt="Логотип" class="logo">
  <h3>Оставьте заявку</h3>
  <input id="name" placeholder="Ваше имя" required><br>
  <input id="phone" placeholder="Телефон" required><br>
  <input id="email" placeholder="Email" type="email" required><br>
  <input id="class" placeholder="Класс" required><br>
  <button onclick="sendForm()">Отправить заявку</button>
</div>

<div id="test" style="display:none;">
  <h3 id="question">Вопрос</h3>
  <div id="answers"></div>
  <div id="solution" style="margin-top:10px;color:green;"></div>
  <button onclick="nextQuestion()" id="nextBtn" style="display:none;">Следующий вопрос</button>
</div>

<div id="final" style="display:none;">
  <h3>Ваш результат: <span id="score"></span>/6</h3>
  <a href="https://t.me/umschoolone" target="_blank">
    <button>Перейти в Telegram канал</button>
  </a>
</div>

<script>
let tg = window.Telegram.WebApp;
let current = 0, score = 0;

let questions = [
  {q:"Сколько Н пишется в слове СОЛНЕЧ..ЫЙ?", a:["Н","НН"], correct:0},
  {q:"Сколько Н пишется в слове ТУМА..ЫЙ?", a:["Н","НН"], correct:1},
  {q:"Сколько Н пишется в слове РУМЯ..ЫЙ?", a:["Н","НН"], correct:0},
  {q:"о..бить, на..ломиться, на..писать – одна буква?", a:["Да","Нет"], correct:1},
  {q:"з..бить, от..двинуть, д..рисовать – одна буква?", a:["Да","Нет"], correct:1},
  {q:"з..красить, н..стигнуть, пр..язык – одна буква?", a:["Да","Нет"], correct:1}
];

function sendForm() {
  let name = document.getElementById("name").value;
  let phone = document.getElementById("phone").value;
  let email = document.getElementById("email").value;
  let classNum = document.getElementById("class").value;

  if (!name || !phone || !email || !classNum) {
    alert("Заполните все поля!");
    return;
  }

  let data = { name, phone, email, classNum };
  tg.sendData(JSON.stringify(data));

  document.getElementById("form").style.display = "none";
  document.getElementById("test").style.display = "block";

  showQuestion();
}

function showQuestion() {
  let q = questions[current];
  document.getElementById("question").textContent = q.q;
  document.getElementById("answers").innerHTML = "";
  document.getElementById("solution").innerHTML = "";
  document.getElementById("nextBtn").style.display = "none";

  q.a.forEach((answer, i) => {
    let btn = document.createElement("button");
    btn.textContent = answer;
    btn.onclick = () => answerQuestion(i);
    document.getElementById("answers").appendChild(btn);
  });
}

function answerQuestion(i) {
  let q = questions[current];
  if (i === q.correct) {
    score++;
  }

  let solutions = [
    "Солнечный — образовано от СОЛНЦЕ, пишем Н.",
    "Туманный — от ТУМАН, пишем НН.",
    "Румяный — исключение, пишем Н.",
    "отбить — ОТ-, надломиться — НАД-, надписать — НАД-, буквы разные.",
    "забить — ЗА-, отодвинуть — ОТО-, дорисовать — ДО-, буквы разные.",
    "закрасить — ЗА-, настигнуть — НА-, праязык — ПРА-, буквы разные."
  ];

  document.getElementById("solution").textContent = solutions[current];
  document.getElementById("nextBtn").style.display = "block";
  document.getElementById("answers").innerHTML = "";
}

function nextQuestion() {
  current++;
  if (current < questions.length) {
    showQuestion();
  } else {
    showFinal();
  }
}

function showFinal() {
  document.getElementById("test").style.display = "none";
  document.getElementById("final").style.display = "block";
  document.getElementById("score").textContent = score;
  tg.MainButton.hide();
}

tg.expand();
</script>

</body>
</html>
